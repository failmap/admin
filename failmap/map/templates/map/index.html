<!DOCTYPE html>{% load static %} {% load i18n %} {% load compress %} {% load countries %}
<html lang="{{ language }}">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Security issues of organizations in {{ country }} displayed a map">

    <meta name="viewport" content="width=device-width, initial-scale=0.5, maximum-scale=5, user-scalable=yes, minimal-ui">
    <meta name="theme-color" content="Tomato"/>

    <!-- export variables to javascript from server configuration -->
    <meta name="mailto" content="{{ config.PROJECT_MAIL }}">
    <meta name="issue_mailto" content="{{ config.PROJECT_ISSUE_MAIL }}">
    <meta name="sentry_token" content="{{ sentry_token }}">
    <meta name="version" content="{{ version }}">
    <meta name="country" content="{{ country }}">
    <meta name="debug" content="{{ debug }}">
    <meta name="mapbox_token" content="{{ config.MAPBOX_ACCESS_TOKEN }}">
    <meta name="initial_map_data_url" content="{{ initial_map_data_url }}">
    <meta name="TICKER_VISIBLE_VIA_JS_COMMAND" content="{{ config.TICKER_VISIBLE_VIA_JS_COMMAND | lower }}">

    <title>{% trans "Site Title" %}</title>

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="format-detection" content="telephone=no">

    <link rel="shortcut icon" type="image/png" href="{% static 'favicons/favicon.ico' %}"/>
    <link rel="apple-touch-icon" href="{% static 'favicons/apple-icon.png' %}">
    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'favicons/apple-icon-57x57.png' %}">
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'favicons/apple-icon-60x60.png' %}">
    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'favicons/apple-icon-72x72.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'favicons/apple-icon-76x76.png' %}">
    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'favicons/apple-icon-114x114.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'favicons/apple-icon-120x120.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'favicons/apple-icon-144x144.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'favicons/apple-icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'favicons/apple-icon-180x180.png' %}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{% static 'favicons/android-icon-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'favicons/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="96x96" href="{% static 'favicons/favicon-96x96.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'favicons/favicon-16x16.png' %}">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="{% static 'favicons/ms-icon-144x144.png' %}">

    <!-- This stylesheet is changed on the fly using themes. -->
    <link rel="stylesheet" type="text/css" id="active_theme" href="{% static 'css/vendor/bootstrap.min.css' %}"/>

    {% compress css %}
        <link rel="stylesheet" type="text/css" href="{% static 'css/vendor/leaflet.css' %}"/>
        <link rel="stylesheet" type="text/css" href="{% static 'css/vendor/leaflet.fullscreen.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/vendor/fa-svg-with-js.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/vendor/MarkerCluster.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/vendor/MarkerCluster.Failmap.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'css/overrides.css' %}">
    {% endcompress %}

    <script type="text/javascript" src="{% url 'javascript-catalog' %}"></script>
    {% if debug %}
        <script type="text/javascript" src="{% static 'js/vendor/vue.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/jquery-3.2.1.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/bootstrap.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/leaflet-src.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/Leaflet.fullscreen.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/leaflet.markercluster-src.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/lazyload-custom.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/raven.min.vue.3.19.1.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/fontawesome.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/fontawesome-all.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/moment-with-locales.js' %}" charset="UTF-8"></script>
        <script type="text/javascript" src="{% static 'js/vendor/Chart.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/failmap.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/views.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/script.js' %}"></script>
    {% else %}{% compress js %}
        <script type="text/javascript" src="{% static 'js/vendor/vue.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/jquery-3.2.1.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/bootstrap.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/leaflet.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/Leaflet.fullscreen.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/leaflet.markercluster.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/lazyload-custom.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/raven.min.vue.3.19.1.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/fontawesome.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/fontawesome-all.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/vendor/moment-with-locales.min.js' %}" charset="UTF-8"></script>
        <script type="text/javascript" src="{% static 'js/vendor/Chart.min.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/failmap.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/views.js' %}"></script>
        <script type="text/javascript" src="{% static 'js/script.js' %}"></script>
    {% endcompress %}{% endif %}

    {% if config.GITTER_CHAT_ENABLE and config.GITTER_CHAT_CHANNEL %}
        <script>
          ((window.gitter = {}).chat = {}).options = {
            room: '{{ config.GITTER_CHAT_CHANNEL }}'
          };
        </script>
        <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
    {% endif %}

    <link rel="manifest" href="/manifest.json">
</head>

<body role="document" onload="document_ready();">

<nav class="navbar navbar-expand-md navbar-light fixed-top bg-light">
    <div class="container">
    <a class="navbar-brand" href="#"><i class="fas fa-map-marker-alt"></i> {% trans "Map" %}</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">

            {% if config.SHOW_INTRO %}
            <li class="nav-item"><a class="nav-link" href="#info"><i class="fas fa-info-circle"></i> {% trans "Info" %}</a></li>
            {% endif %}

            {% if config.SHOW_GOOD_BAD %}
            <li class="nav-item"><a class="nav-link" href="#charts"><i class="fas fa-list-ol"></i> {% trans "Charts" %}</a></li>
            {% endif %}

            <li class="nav-item"><a class="nav-link" href="#reports"><i class="far fa-file-alt"></i> {% trans "Reports" %}</a></li>

            {% if config.SHOW_EXTENSIVE_STATISTICS %}
            <li class="nav-item"><a class="nav-link" href="#extensive_statistics"><i class="fas fa-chart-area"></i> {% trans "Statistics" %}</a></li>
            {% endif %}

            {% if config.SHOW_COMPLY_OR_EXPLAIN %}
            <li class="nav-item"><a class="nav-link" href="#comply_or_explain_info"><i class='fas fa-comments'></i> {% trans "Comply or explain" %}</a></li>
            {% endif %}

            {% if config.SHOW_SCAN_SCHEDULE %}
            <li class="nav-item"><a class="nav-link" href="#schedule"><i class="far fa-clock"></i> {% trans "Scan schedule" %}</a></li>
            {%  endif %}

            {% if config.SHOW_DATASETS %}
            <li class="nav-item"><a class="nav-link" href="#datasets"><i class="fas fa-download"></i> {% trans "Datasets" %}</a></li>
            {% endif %}
        </ul>
        {% comment %}nav-link does not have a "padding only" variant, even the content examples everything sticks together, which is ugly/chaotic.{% endcomment %}
        <ul class="navbar-nav navbar-right ml-auto">
            <li class="nav-item nav-link" style="padding-right:20px;">
                <a href="https://failmap.org"><img src="{% static 'images/fail_logo.png' %}" alt="logo" width="24px" class="d-inline-block align-top"/></a>
            </li>
            <li class="nav-item nav-link" style="padding-right:20px;">
                <a href="https://gitlab.com/failmap/failmap/"><img src="{% static 'images/gitlab_logo_small.png' %}" alt="gitlab logo" width="24px" class="d-inline-block align-top"/></a>
            </li>
        </ul>
    </div>
    </div>
</nav>

<div id="map_state_bar">

    {% if number_of_countries > 1 %}
    <nav class="navbar navbar-expand-md navbar-light" id="countrynavbar">
        <div class="container">
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto">

                    {% for country in initial_countries %}
                        {% get_country country as country_details %}
                    <li class="nav-item" v-bind:class="[selected_country == '{{ country_details.code }}' ? 'selected_country' : '']">
                        <a  class="nav-link" v-on:click="set_country('{{ country_details.code }}')">
                            <img src="{{ country_details.flag }}" width="16" height="10">
                            {{ country_details.name }}</a>
                    </li>

                    {% endfor %}

                </ul>
            </div>
        </div>
    </nav>
    {% endif %}

    <nav class="navbar navbar-expand-md navbar-light" id="layernavbar" v-if="layers.length > 1" v-cloak>
        <div class="container">
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item" v-for="(x, key) in layers" v-bind:class="[selected_layer == x ? 'selected_layer' : '']">
                        <a class="nav-link" v-on:click="set_layer(x)">
                            {% verbatim %}{{ translate("category_menu_" + x) }}{% endverbatim %}</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    {% if debug or admin %}
    <nav class="navbar navbar-expand-md navbar-light">
        <div class="container">
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#adminbarcollapse" aria-controls="adminbarcollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
        <div class="collapse navbar-collapse" id="adminbarcollapse">
            <ul class="navbar-nav mr-auto">

                {% if debug %}
                <li class="nav-item nav-link"><span class='btn btn-danger btn-sm'><i class="fas fa-bug"></i> {% trans "DEBUG" %}</span></li>
                {% endif %}

            </ul>
            {% comment %}nav-link does not have a "padding only" variant, even the content examples everything sticks together, which is ugly/chaotic.{% endcomment %}
            <ul class="navbar-nav navbar-right ml-auto">
            {% if admin %}
                <li class="nav-item nav-link"><span class="badge badge-secondary">{{ version }}</span></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'admin:index' %}">{% trans "Admin" %}</a></li>
                <li class="nav-item"><a class="nav-link" onclick="failmap.loadTiles()">{% trans "Load Tiles" %}</a></li>
                <!-- This allows testing different themes -->
                <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Theme<span class="caret"></span></a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown3">
                            <a href="#" data-theme="default" class="dropdown-item theme-link">Default</a>
                            <a href="#" data-theme="darkly" class="dropdown-item theme-link">Darkly</a>
                        </div>
                    </li>
            {% endif %}
            </ul>
        </div>
        </div>
    </nav>
    {% endif %}
</div>

{% if config.SHOW_ANNOUNCEMENT and config.ANNOUNCEMENT %}
<section class="announcement">
   <div class="container">
        <div class="row">
            <div class="col-md-12">
                <i class="fas fa-bell"></i> {{ config.ANNOUNCEMENT|safe }}
            </div>
        </div>
    </div>
</section>
{% endif %}

<section>
    <div id='map'></div>
</section>

{% if config.SHOW_INTRO %}
<section>
    <div class="container theme-showcase" role="main">
        <a name="info" class="jumptonav"></a>
        <div class="jumbotron">
            <h1 class="display-4"><i class="fas fa-info-circle"></i> {% trans "What do i see?" %}</h1>
            <p class="lead">{% trans "whats do i see explained" %}</p>
            <p>{% blocktrans with RESPONSIBLE_ORGANIZATION_NAME=config.RESPONSIBLE_ORGANIZATION_NAME PROJECT_ISSUE_MAIL=config.PROJECT_ISSUE_MAIL %} This website is run by {{ RESPONSIBLE_ORGANIZATION_NAME }}. To submit new domains, or ask questions, contact us via: {{ PROJECT_ISSUE_MAIL }}.{% endblocktrans %}</p>
        </div>
    </div>
</section>
{% endif %}

{% if config.SHOW_GOOD_BAD %}
<section>
   <div class="container">

       <div id="charts">
            <div class="page-header">
                <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                <a name="charts" class="jumptonav"></a>
                <h2><i class="fas fa-list-ol"></i> {% trans "Charts" %}</h2>
                <p>{% trans "Chart introduction" %}</p>
                <p></p>
            </div>
            <div class="row">
                {% include "map/topfail.html" %}
            </div>
            <div class="row">
                {% include "map/topwin.html" %}
            </div>
        </div>
  </div>
</section>
{% endif %}

<section name="report">
    <div class="container">
        <div class="page-header" id="report">
            <div>
                <div class="page-header">
                    <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                    <a name="reports" id="report-anchor" class="jumptonav"></a>
                    <h2><span class="organization_points"></span><i class="far fa-file-alt"></i> {% trans "Report" %}</h2>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        {% trans "Show report for organization" %}:
                        {% verbatim %}
                        <select v-model="selected">
                            <option v-for="organization in organizations" :value="organization.name">
                                {{ organization.name }}
                            </option>
                        </select>
                        <span v-if='loading'><div class="fa fa-spinner fa-spin"></div></span>
                        {% endverbatim %}
                        <br />
                    </div>
                </div>
                <br /><br />
                <div class="row">
                    <div v-if="name" id="reportcontent" class="col-md-12">
                        <h3>{% trans "Report for" %} {% verbatim %}{{ name }}{% endverbatim %}</h3>
                        <br/>
                        <a @click="closereport()" class="btn btn-primary" style="color:white;"><i class="fas fa-times"></i> {% trans "close report" %}</a>
                        <a @click="printreport('reportcontent')" class="btn btn-success" style="color:white;"><i class="fas fa-print"></i> {% trans "print report" %}</a>
                        <br style="clear: both">
                        <i>{% trans "Data from" %}: {% verbatim %}{{ humanize(when) }}{% endverbatim %}.</i><br/>
                        <br/>
                        <ul>
                        <li v-if="promise" id="promise"><strong>*</strong> {% trans "Promise message" %}
                        </li>
                        <li>{% trans "RSS change feed teaser" %}
                        <a :href="'/data/updates_on_organization_feed/' + selected"
                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</li>
                        <li>
                        {% trans "Report ask domains leader" %} <a
                            :href="'mailto:{{ config.PROJECT_ISSUE_MAIL }}?subject={% trans "Report ask domains subject" %}' + name + '&body={% trans "Report ask domains body" %}'">{% trans "Report ask sendin domains" %}</a><br/>
                        </li>
                        </ul>
                        <br style="clear: both">
                        <div class="score high">
                            <span class="score_value high_text">{% verbatim %}{{ high }}{% endverbatim %}</span><br/>
                            <span class="score_label">{% trans "High" %}</span>
                        </div>

                        <div class="score medium">
                            <span class="score_value medium_text">{% verbatim %}{{ medium }}{% endverbatim %}</span><br/>
                            <span class="score_label">{% trans "Medium" %}</span>
                        </div>

                        <div class="score low">
                            <span class="score_value low_text">{% verbatim %}{{ low }}{% endverbatim %}</span><br/>
                            <span class="score_label">{% trans "Low" %}</span>
                        </div>
                        <br /><br /><br />
                        <br style="clear: both">
                        <br />

                        <h4>{% trans "Risks and internet connectivity over time" %}</h4>
                        <p></p>
                        <br style="clear: both">

                        <div class="chart-container" style="position: relative; height:555px; width:100%">
                            <canvas id="organization_vulnerability_timeline"></canvas>
                        </div>

                        <br />
                        <div class="chart-container" style="position: relative; height:555px; width:100%">
                            <canvas id="organization_connectivity_timeline"></canvas>
                        </div>

                        <br style="clear: both">

                        <h4>{% trans "Risk summary overview" %}</h4>
                        <p></p>
                        {% verbatim %}
                        <div class="table-responsive">
                        <table class="table table-striped table-bordered table-hover table-sm">
                            <thead>
                            <tr>
                                <th style="width:40%"></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "DNSSEC" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "tls_qualys_encryption_quality" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "tls_qualys_certificate_trusted" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "plain_https" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "Strict-Transport-Security" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "X-Frame-Options" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "X-Content-Type-Options" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "X-XSS-Protection" %}{% verbatim %}</span></div></th>
                                <th style="white-space: nowrap; vertical-align: bottom; height: 240px;"><div style="transform: translate(21px, -10px) rotate(315deg); width: 30px;"><span>{% endverbatim %}{% trans "FTP" %}{% verbatim %}</span></div></th>

                            </thead>
                            <tbody style="max-height: 240px; overflow-y: scroll">
                            <template v-for="url in urls" >
                                <tr v-html="total_summary_row(url)"></tr>
                                <!-- Use this for debugging. -->
                                <!-- <tr v-html="endpoint_summary_row(url, false)"></tr>
                                <tr v-for="endpoint in url.endpoints" v-html="endpoint_summary_row(endpoint, true)"></tr>
                                -->
                            </template>
                            </tbody>
                        </table>
                        </div>
                        {% endverbatim %}

                        <br style="clear: both">

                        <h4>{% trans "Full report" %}</h4>
                        <p></p>
                        {% verbatim %}
                        <div v-for="url in urls" class="perurl"
                             :style="'background: linear-gradient(' + colorizebg(url.high, url.medium, url.low) + ', rgba(255, 255, 255, 0.0));'">

                            <div class="row">
                                <div class="col-md-4">
                                    &nbsp;
                                </div>
                                <div class="col-md-8">
                                    <span v-html="total_awarded_points(url.high, url.medium, url.low)"> </span>
                                    <span class="faildomain" :class="colorize(url.high, url.medium, url.low)" :data-tooltip-content="idizetag(url.url)">{{ url.url }}</span><br/>
                                    <a :href="'mailto:{% endverbatim %}{{ config.PROJECT_ISSUE_MAIL }}{% verbatim %}?subject={% endverbatim %}{% trans "Incorrect finding on mail subject" %}{% verbatim %}' + url.url + '&body={% endverbatim %}{% trans "Incorrect finding on mail body" %}{% verbatim %}'" class="btn btn-secondary btn-sm" style="margin-top: 11px;" role="button">
                                        {% endverbatim %}{% trans "Report incorrect finding" %}</a>
                                </div>
                            </div>

                            <!-- url reports -->
                            <div v-if="url.ratings.length > 0" class="row">
                                <div class="col-md-4">
                                    &nbsp;
                                </div>
                                <div class="col-md-8 giveroom_url">
                                    <h4>{% trans "Url level findings" %}</h4>
                                    {% verbatim %}
                                    <div v-for="rating in url.ratings">
                                        <h5>&nbsp; {{ create_header(rating) }}</h5>
                                        <div class="finding_block">
                                            <span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                            {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}
                                            <div class="finding_references">
                                                    <span v-html="second_opinion_links(rating, url)"> </span>
                                                    {% endverbatim %}
                                                    {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                                                        <span class="explain_link" v-html="explain_link('{{ config.COMPLY_OR_EXPLAIN_EMAIL_ADDRESS }}', rating, url)"></span>
                                                    {% endif %}{% verbatim %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- endpoint reports -->
                            <div v-for="endpoint in url.endpoints" class="row">
                                <div class="col-md-4 giveroom photobar">
                                    <a :href="endpoint.protocol + '://' + url.url + ':' + endpoint.port"
                                       target="_blank"
                                       :title="'Visit ' + endpoint.protocol + '://' + url.url + ':' + endpoint.port">
                                        <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs="
                                             class="lazyload clippedimage" :data-src="'/static/images/screenshots/' + endpoint.ip_version + '_' + endpoint.protocol + idize(url.url) + endpoint.port + '_latest.png'"
                                            :alt="'Latest screenshot of '+ endpoint.protocol + idize(url.url) + endpoint.port"
                                        />
                                    </a>
                                </div>
                                <div class="col-md-8 giveroom">
                                    <h4>{% endverbatim %}{% trans "Service" %}: {% verbatim %}{{endpoint_type(endpoint) }}</h4>

                                    <div>
                                        <div v-for="rating in endpoint.ratings">
                                            <h5>&nbsp; {{ create_header(rating) }}</h5>
                                            <div class="finding_block" v-if="rating.comply_or_explain_valid_at_time_of_report">
                                                <span class="awarded_points_explained">{% endverbatim %}{% trans "Explained" %}{% verbatim %}</span> {{ rating.comply_or_explain_explanation }}<br />
                                                {% endverbatim %}{% trans "Explained on" %}{% verbatim %}: {{ humanize(rating.comply_or_explain_explained_on) }}, {% endverbatim %}{% trans "explanation expires" %}{% verbatim %}: {{ humanize(rating.comply_or_explain_explanation_valid_until) }}<br>
                                                <del style="font-size: 0.8em"><span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                                {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}</del>
                                                <div class="finding_references" v-html="second_opinion_links(rating, url)"> </div>
                                            </div>
                                            <div class="finding_block" v-else>
                                                <span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                                {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}

                                                <div class="finding_references">
                                                    <span v-html="second_opinion_links(rating, url)"> </span>
                                                    {% endverbatim %}
                                                    {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                                                        <span class="explain_link" v-html="explain_link('{{ config.COMPLY_OR_EXPLAIN_EMAIL_ADDRESS }}', rating, url)"></span>
                                                    {% endif %}
                                                </div>
                                                {% verbatim %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endverbatim %}
                </div>
            </div>
        </div>
    </div>
</section>

{% if config.SHOW_EXTENSIVE_STATISTICS %}
<section name="extensive_statistics">
    <div class="container">

        {% if config.SHOW_STATS_NUMBERS %}
        <div id="statistics" v-cloak>
            <div class="page-header">
                <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                <a name="extensive_statistics" class="jumptonav"></a>
                <h2><i class="fas fa-chart-area"></i> {% trans "Extensive statistics" %}</h2>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <h3>{% trans "Organizations" %}</h3>
                    <p>{% trans "Organizations Explained" %}</p>
                </div>
                <div class="col-md-6">
                    <h3>{% trans "Internet addresses" %}</h3>
                    <p>{% trans "Internet addresses Explained" %}</p>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="progress">
                        <div class="progress-bar bg-success" :style="{width:greenpercentage}">
                            <span class="sr-only">{% trans "stats remark green" %}</span>
                        </div>
                        <div class="progress-bar bg-warning" :style="{width:orangepercentage}">
                            <span class="sr-only">{% trans "stats remark orange" %}</span>
                        </div>
                        <div class="progress-bar bg-danger" :style="{width:redpercentage}">
                            <span class='sr-only'>{% trans "stats remark red" %}</span>
                        </div>
                        <div class="progress-bar bg-basic" :style="{width:unknownpercentage}">
                            <span class='sr-only'>{% trans "stats remark gray" %}</span>
                        </div>
                    </div>

                    <table class="table">
                        <thead>
                        <tr>
                            <th width="25%">{% trans "When" %}</th>
                            <th width="5%">{% trans "Number" %}</th>
                            <th width="20%">{% trans "Good" %}</th>
                            <th width="20%">{% trans "Average" %}</th>
                            <th width="20%">{% trans "Bad" %}</th>
                        </tr>
                        </thead>
                        <tbody v-if="data.data">
                        {% verbatim %}
                        <tr v-for="(x, key) in data.data">
                            <td>{{ translate(key) }}</td>
                            <td>{{ x["included_organizations"] }}</td>
                            <td :style="'background: linear-gradient(0deg, rgba(93, 255, 42, 0.2) 0%, rgba(93, 255, 42, 0.2) ' + x['green percentage'] + '%, transparent ' + x['green percentage'] + '%, transparent 100%);'">
                                {{ x["green"] }}
                                <small>({{ x["green percentage"] }}%)</small>
                            </td>
                            <td :style="'background: linear-gradient(0deg, rgba(255, 211, 134, 0.19) 0%, rgba(255, 211, 134, 0.19) ' + x['orange percentage'] + '%, transparent ' + x['orange percentage'] + '%, transparent 100%);'">
                                {{ x["orange"] }}
                                <small>({{ x["orange percentage"] }}%)</small>
                            </td>
                            <td :style="'background: linear-gradient(0deg, rgba(255, 42, 42, 0.2) 0%, rgba(255, 42, 42, 0.2) ' + x['red percentage'] + '%, transparent ' + x['red percentage'] + '%, transparent 100%);'">
                                {{ x["red"] }}
                                <small>({{ x["red percentage"] }}%)</small>
                            </td>
                        </tr>
                        {% endverbatim %}
                        </tbody>
                    </table>
                </div>
                <div class="col-md-6">
                    <div class="progress">
                        <div class="progress-bar bg-success" :style="{width:greenurlpercentage}">
                            <span class="sr-only">{% trans "stats remark green" %}</span>
                        </div>
                        <div class="progress-bar bg-warning" :style="{width:orangeurlpercentage}">
                            <span class="sr-only">{% trans "stats remark orange" %}</span>
                        </div>
                        <div class="progress-bar bg-danger" :style="{width:redurlpercentage}">
                            <span class='sr-only'>{% trans "stats remark red" %}</span>
                        </div>
                    </div>
                    <table class="table">
                        <thead>
                        <tr>
                            <th width="25%">{% trans "When" %}</th>
                            <th width="5%">{% trans "Number" %}</th>
                            <th width="20%">{% trans "Good" %}</th>
                            <th width="20%">{% trans "Average" %}</th>
                            <th width="20%">{% trans "Bad" %}</th>
                        </tr>
                        </thead>
                        <tbody v-if="data.data">
                        {% verbatim %}
                        <tr v-for="(x, key) in data.data">
                            <td>{{ translate(key) }}</td>
                            <td>{{ x["total_urls"] }}</td>
                            <td :style="'background: linear-gradient(0deg, rgba(93, 255, 42, 0.2) 0%, rgba(93, 255, 42, 0.2) ' + x['green url percentage'] + '%, transparent ' + x['green url percentage'] + '%, transparent 100%);'">
                                {{ x["green_urls"] }}
                                <small>({{ x["green url percentage"] }}%)</small>
                            </td>
                            <td :style="'background: linear-gradient(0deg, rgba(255, 211, 134, 0.19) 0%, rgba(255, 211, 134, 0.19) ' + x['orange url percentage'] + '%, transparent ' + x['orange url percentage'] + '%, transparent 100%);'">
                                {{ x["orange_urls"] }}
                                <small>({{ x["orange url percentage"] }}%)</small>
                            </td>
                            <td :style="'background: linear-gradient(0deg, rgba(255, 42, 42, 0.2) 0%, rgba(255, 42, 42, 0.2) ' + x['red url percentage'] + '%, transparent ' + x['red url percentage'] + '%, transparent 100%);'">
                                {{ x["red_urls"] }}
                                <small>({{ x["red url percentage"] }}%)</small>
                            </td>
                        </tr>
                        {% endverbatim %}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row">
                {% if config.SHOW_HTTP_TLS_QUALYS or config.SHOW_HTTP_MISSING_TLS %}
                <div class="col-md-6">
                    <h4>{% trans "Technical TLS" %}</h4>
                    <p>{% trans "Technical stats TLS explained" %}</p>
                </div>
                {% endif %}
                {% if config.SHOW_HTTP_HEADERS_X_XSS or config.SHOW_HTTP_HEADERS_X_CONTENT or config.SHOW_HTTP_HEADERS_HSTS or config.SHOW_HTTP_HEADERS_XFO %}
                <div class="col-md-6">
                    <h4>{% trans "Technical stats headers" %}</h4>
                    <p>{% trans "Technical stats headers explained" %}</p>
                </div>
                {% endif %}
            </div>
            <div class="row" v-if="data.data">
                {% if config.SHOW_HTTP_TLS_QUALYS or config.SHOW_HTTP_MISSING_TLS %}
                <div class="col-md-6">
                    <div v-for="(x, key) in data.data" v-if="key == 'now'">
                        <table class="table" v-if="x['explained']">
                            <thead>
                            <tr>
                                <th width="10%">{% trans "Technology" %}</th>
                                <th width="50%">{% trans "Result" %}</th>
                                <th width="40%">{% trans "Total" %}</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% if config.SHOW_DNS_DNSSEC %}

                            <tr v-if="x['explained']['DNSSEC']">
                                <td colspan="3">{% trans "DNSSEC" %}</td>
                            </tr>
                            <tr v-if="x['explained']['DNSSEC']" class="redrow">
                                <td></td>
                                <td>{% trans "DNSSEC incorrect" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['DNSSEC']['DNSSEC is incorrectly or not configured (errors found).'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['DNSSEC']" class="greenrow">
                                <td></td>
                                <td>{% trans "DNSSEC correct" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['DNSSEC']['DNSSEC seems to be implemented sufficiently.'] }}{% endverbatim %}</td>
                            </tr>
                            {% endif %}

                            {% if config.SHOW_FTP %}
                            <tr v-if="x['explained']['ftp']">
                                <td colspan="3">{% trans "FTP" %}</td>
                            </tr>
                            <tr v-if="x['explained']['ftp']" class="redrow">
                                <td></td>
                                <td>{% trans "FTP insecure" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['ftp']['FTP Server does not support encrypted transport or has protocol issues.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['ftp']" class="redrow">
                                <td></td>
                                <td>{% trans "FTP outdated" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['ftp']['FTP Server only supports insecure SSL protocol.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['ftp']" class="greenrow">
                                <td></td>
                                <td>{% trans "FTP secure" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['ftp']['FTP Server supports TLS encryption protocol.'] }}{% endverbatim %}</td>
                            </tr>
                            {% endif %}

                            {% if config.SHOW_HTTP_MISSING_TLS %}
                            <tr v-if="x['explained']['plain_https']">
                                <td colspan="3">{% trans "Application of encryption" %}</td>
                            </tr>
                            <tr v-if="x['explained']['plain_https']" class="redrow">
                                <td></td>
                                <td>{% trans "Not at all" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['plain_https']['Site does not redirect to secure url, and has nosecure alternative on a standard port.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['plain_https']" class="redrow">
                                <td></td>
                                <td>{% trans "Not at all" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['plain_https']['Site does not redirect to secure url, and has no secure alternative on a standard port.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['plain_https']" class="orangerow">
                                <td></td>
                                <td>{% trans "Redirect from unsafe address" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['plain_https']['Redirects to a secure site, while a secure counterpart on the standard port is missing.'] }}{% endverbatim %}</td>
                            </tr>
                            {% endif %}

                            {% if config.SHOW_HTTP_TLS_QUALYS %}
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']">
                                <td colspan="3">{% trans "Encryption quality" %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="redrow">
                                <td></td>
                                <td>{% trans "Broken" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Broken Transport Security, rated F'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="orangerow">
                                <td></td>
                                <td>{% trans "TLS rated C" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Less than optimal Transport Security, rated C.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="orangerow">
                                <td></td>
                                <td>{% trans "TLS rated B" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Less than optimal Transport Security, rated B.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="greenrow">
                                <td></td>
                                <td>{% trans "TLS rated A-" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Good Transport Security, rated A-.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="greenrow">
                                <td></td>
                                <td>{% trans "TLS rated A" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Good Transport Security, rated A.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']" class="greenrow">
                                <td></td>
                                <td>{% trans "TLS rated A+" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_encryption_quality']['Perfect Transport Security, rated A+.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_encryption_quality']">
                                <td colspan="3">{% trans "Certificate trust" %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_certificate_trusted']" class="redrow">
                                <td></td>
                                <td>{% trans "No trust" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_certificate_trusted']['Certificate is not trusted.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['tls_qualys_certificate_trusted']" class="greenrow">
                                <td></td>
                                <td>{% trans "Trust" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['tls_qualys_certificate_trusted']['Certificate is trusted.'] }}{% endverbatim %}</td>
                            </tr>
                            {%  endif %}
                            </tbody>
                        </table>
                    </div>
                </div>
                {% endif %}
                {% if config.SHOW_HTTP_HEADERS_X_XSS or config.SHOW_HTTP_HEADERS_X_CONTENT or config.SHOW_HTTP_HEADERS_HSTS or config.SHOW_HTTP_HEADERS_XFO %}
                <div class="col-md-6">
                    <div v-for="(x, key) in data.data" v-if="key == 'now'">
                        <table class="table" v-if="x['explained']">
                            <thead>
                            <tr>
                                <th width="10%">{% trans "Technology" %}</th>
                                <th width="50%">{% trans "Result" %}</th>
                                <th width="40%">{% trans "Total" %}</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr v-if="x['explained']['http_security_header_strict_transport_security']">
                                <td colspan="3">{% trans "Stats HSTS" %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_strict_transport_security']" class="orangerow">
                                <td></td>
                                <td>{% trans "Stats hasn't" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_strict_transport_security']['Missing Strict-Transport-Security header.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_strict_transport_security']" class="greenrow">
                                <td></td>
                                <td>{% trans "Stats has" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_strict_transport_security']['Strict-Transport-Security header present.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_frame_options']">
                                <td colspan="3">{% trans "Stats X-Frame-Options" %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_frame_options']" class="orangerow">
                                <td></td>
                                <td>{% trans "Stats hasn't" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_frame_options']['Missing X-Frame-Options header.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_frame_options']" class="greenrow">
                                <td></td>
                                <td>{% trans "Stats has" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_frame_options']['X-Frame-Options header present.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_xss_protection']">
                                <td colspan="3">{% trans "Stats X-XSS Protection" %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_xss_protection']" class="orangerow">
                                <td></td>
                                <td>{% trans "Stats hasn't" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_xss_protection']['Missing X-XSS-Protection header.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_xss_protection']" class="greenrow">
                                <td></td>
                                <td>{% trans "Stats has" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_xss_protection']['X-XSS-Protection header present.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_content_type_options']">
                                <td colspan="3">{% trans "Stats X-Content Type Options" %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_content_type_options']" class="orangerow">
                                <td></td>
                                <td>{% trans "Stats hasn't" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_content_type_options']['Missing X-Content-Type-Options header.'] }}{% endverbatim %}</td>
                            </tr>
                            <tr v-if="x['explained']['http_security_header_x_content_type_options']" class="greenrow">
                                <td></td>
                                <td>{% trans "Stats has" %}:</td>
                                <td>{% verbatim %}{{ x['explained']['http_security_header_x_content_type_options']['X-Content-Type-Options header present.'] }}{% endverbatim %}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                {% endif %}
            </div>
            {% if config.SHOW_SERVICES %}
            <div class="row">
                <div class="col-md-12" v-for="(x, key) in data.data" v-if="key == 'now'">
                    <h3>{% trans "Services" %}</h3>
                    <p>{% trans "Services explained" %}</p>
                        <p>{% trans "Number of service checked" %}</p>
                        <table class="table table-striped" id="services_table">
                            <thead>
                                <tr>
                                    <th @click="sortBy('ip_version')" :class="{ active: sortKey == 'ip_version' }">
                                        {% trans "IP Version" %}
                                        <span class="arrow" :class="sortOrders['ip_version'] > 0 ? 'asc' : 'dsc'">
                                    </th>
                                    <th @click="sortBy('protocol')" :class="{ active: sortKey == 'protocol' }">
                                        {% trans "Protocol" %}
                                        <span class="arrow" :class="sortOrders['protocol'] > 0 ? 'asc' : 'dsc'">
                                    </th>
                                    <th @click="sortBy('port')" :class="{ active: sortKey == 'port' }">
                                        {% trans "Port" %}
                                        <span class="arrow" :class="sortOrders['port'] > 0 ? 'asc' : 'dsc'">
                                    </th>
                                    <th @click="sortBy('amount')" :class="{ active: sortKey == 'amount' }">
                                        {% trans "Amount" %}
                                        <span class="arrow" :class="sortOrders['amount'] > 0 ? 'asc' : 'dsc'">
                                    </th>
                                    <th>{% trans "Percentage" %}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% verbatim %}
                                <tr v-for="service in filteredData">
                                    <td>{{ service['ip_version'] }}</td>
                                    <td>{{ service['protocol'] }}</td>
                                    <td>{{ service['port'] }}</td>
                                    <td>{{ service['amount'] }}</td>
                                    <td>{{ ((service['amount']/endpoints_now) * 100).toFixed(2) }}%</td>
                                </tr>
                                {% endverbatim %}
                            </tbody>
                        </table>
                    </div>
            </div>
            {% endif %}
        </div>
        {% endif %}

        {% if config.SHOW_STATS_IMPROVEMENTS %}
        <div id="issue_improvements" class="stats_part" v-cloak>
            <div class="page-header">
                <h3>{% trans "Improvements" %}</h3>
                <p>{% trans "Improvements explained" %}</p>
            </div>
            <div class="row">
                <div class="col-md-4" style="text-align:center">
                    <h4>{% trans "High risk improvements" %}</h4>

                    <span :class="goodbad(overall.high) + '_large'">{% verbatim %}{{ overall.high }}{% endverbatim %}</span>


                    <table class="table table-striped">
                        <tr>
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td>{% trans "Encryption Quality" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td :class="'number-sm ' + goodbad(tls_qualys_encryption_quality.high)">{% verbatim %}{{ tls_qualys_encryption_quality.high }}{% endverbatim %}</td> {% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td>{% trans "Certificate Trust" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td :class="'number-sm ' + goodbad(tls_qualys_certificate_trusted.high)">{% verbatim %}{{ tls_qualys_certificate_trusted.high }}{% endverbatim %}</td> {% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_MISSING_TLS %}<td>{% trans "Missing encryption" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_MISSING_TLS %}<td :class="'number-sm ' + goodbad(plain_https.high)">{% verbatim %}{{ plain_https.high }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_FTP %}<td>{% trans "Missing FTP encryption" %}</td>{% endif %}
                            {% if config.SHOW_FTP %}<td :class="'number-sm ' + goodbad(ftp.high)">{% verbatim %}{{ ftp.high }}{% endverbatim %}</td>{% endif %}
                        </tr>
                    </table>

                </div>
                <div class="col-md-4" style="text-align:center">
                    <h4>{% trans "Medium risk improvements" %}</h4>

                    <span :class="goodbad(overall.medium) + '_large'">{% verbatim %}{{ overall.medium }}{% endverbatim %}</span>

                    <table class="table table-striped">
                        <tr>
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td>{% trans "Encryption" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td :class="'number-sm ' + goodbad(tls_qualys_encryption_quality.medium)">{% verbatim %}{{ tls_qualys_encryption_quality.medium }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_MISSING_TLS %}<td>{% trans "Missing encryption" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_MISSING_TLS %}<td :class="'number-sm ' + goodbad(plain_https.medium)">{% verbatim %}{{ plain_https.medium }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_HEADERS_HSTS %}<td>{% trans "HSTS Header" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_HEADERS_HSTS %}<td :class="'number-sm ' + goodbad(http_security_header_strict_transport_security.medium)">{% verbatim %}{{ http_security_header_strict_transport_security.medium }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_HEADERS_XFO %}<td>{% trans "XFO Header" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_HEADERS_XFO %}<td :class="'number-sm ' + goodbad(http_security_header_x_frame_options.medium)">{% verbatim %}{{ http_security_header_x_frame_options.medium }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_FTP %}<td>{% trans "FTP connection issue (security unknown)" %}</td>{% endif %}
                            {% if config.SHOW_FTP %}<td :class="'number-sm ' + goodbad(ftp.medium)">{% verbatim %}{{ ftp.medium }}{% endverbatim %}</td>{% endif %}
                        </tr>
                    </table>
                </div>
                <div class="col-md-4" style="text-align:center">
                    <h4>{% trans "Low risk improvements" %}</h4>

                    <span :class="goodbad(overall.low) + '_large'">{% verbatim %}{{ overall.low }}{% endverbatim %}</span>

                    <table class="table table-striped">
                        <tr>
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td>{% trans "Encryption" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_TLS_QUALYS %}<td :class="'number-sm ' + goodbad(tls_qualys_encryption_quality.low)">{% verbatim %}{{ tls_qualys_encryption_quality.low }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_HEADERS_X_XSS %}<td>{% trans "X-XSS" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_HEADERS_X_XSS %}<td :class="'number-sm ' + goodbad(http_security_header_x_xss_protection.low)">{% verbatim %}{{ http_security_header_x_xss_protection.low }}{% endverbatim %}</td>{% endif %}
                        </tr>
                        <tr>
                            {% if config.SHOW_HTTP_HEADERS_X_CONTENT %}<td>{% trans "X-Content" %}</td>{% endif %}
                            {% if config.SHOW_HTTP_HEADERS_X_CONTENT %}<td :class="'number-sm ' + goodbad(http_security_header_x_content_type_options.low)">{% verbatim %}{{ http_security_header_x_content_type_options.low }}{% endverbatim %}</td>{% endif %}
                        </tr>
                    </table>

                </div>
            </div>

        </div>
        {% endif %}

        {% if config.SHOW_STATS_GRAPHS %}
        <div id="graphs" class="stats_part" v-cloak>
            <div class="page-header">
                <h3>{% trans "Graphs" %}</h3>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <h4>{% trans "Overall" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_all_vulnerabilities"></canvas>
                    </div>
                    <div class="chart-container" style="position: relative; height:300px; width:100%">
                        <canvas id="timeline_available_urls_and_endpoints"></canvas>
                    </div>
                </div>
            </div>

            <div class="row">

                {% if config.SHOW_HTTP_TLS_QUALYS %}
                <div class="col-md-6">
                    <h4>{% trans "Encryption quality issues (TLS)" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_tls_qualys_encryption_quality_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_TLS_QUALYS %}
                <div class="col-md-6">
                    <h4>{% trans "Certificate trust issues (TLS)" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_tls_qualys_certificate_trusted_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_MISSING_TLS %}
                <div class="col-md-6">
                    <h4>{% trans "Lack of encryption failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_missing_https_encryption_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_FTP %}
                <div class="col-md-6">
                    <h4>{% trans "FTP failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_unencrypted_ftp_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_DNS_DNSSEC %}
                <div class="col-md-6">
                    <h4>{% trans "DNSSEC failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_dnssec_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_HSTS %}
                <div class="col-md-6">
                    <h4>{% trans "Forcing of encryption failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_hsts_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_XFO %}
                <div class="col-md-6">
                    <h4>{% trans "X-Frame Options failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_xfo_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}


                {% if config.SHOW_HTTP_HEADERS_X_CONTENT %}
                <div class="col-md-6">
                    <h4>{% trans "X-Content-Type-Options failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_xcto_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_X_XSS%}
                <div class="col-md-6">
                    <h4>{% trans "X-XSS-Protection failure" %}</h4>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="timeline_xxss_vulnerabilities"></canvas>
                    </div>
                </div>
                {% endif %}

            </div> <!-- Graphs Row -->
        </div>
        {% endif %}

        {% if config.SHOW_STATS_CHANGES %}
        <div id="latest_scans" class="stats_part">
            <div class="page-header">
                <h3>{% trans "Latest changes" %}</h3>
                <p>{% trans "Latest changes explanation" %}</p>
            </div>

            <div class="row">
                {% if config.SHOW_HTTP_TLS_QUALYS %}
                <div class="col-md-6">
                    <h4>{% trans "Encryption quality updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/tls_qualys_encryption_quality"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_tls_qualys_encryption_quality"></span>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_TLS_QUALYS %}
                <div class="col-md-6">
                    <h4>{% trans "Certificate trust updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/tls_qualys_certificate_trusted"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_tls_qualys_certificate_trusted"></span>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_MISSING_TLS %}
                <div class="col-md-6">
                    <h4>{% trans "Lack of encryption updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/plain_https"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_plain_https"></span>
                </div>
                {% endif %}

                {% if config.SHOW_FTP %}
                <div class="col-md-6">
                    <h4>{% trans "FTP updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/ftp"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_ftp"></span>
                </div>
                {% endif %}

                {% if config.SHOW_DNS_DNSSEC %}
                <div class="col-md-6">
                    <h4>{% trans "DNSSEC updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/DNSSEC"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_DNSSEC"></span>
                </div>
                {%  endif %}

                {% if config.SHOW_HTTP_HEADERS_HSTS %}
                <div class="col-md-6">
                    <h4>{% trans "Forcing encryption updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/http_security_header_strict_transport_security"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_http_security_header_strict_transport_security"></span>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_XFO %}
                <div class="col-md-6">
                    <h4>{% trans "X-Frame-Options updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %}<a href="/data/feed/http_security_header_x_frame_options"
                                                       target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_http_security_header_x_frame_options"></span>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_X_CONTENT %}
                <div class="col-md-6">
                    <h4>{% trans "X-Content-Type-Option updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/http_security_header_x_content_type_options"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_http_security_header_x_content_type_options"></span>
                </div>
                {% endif %}

                {% if config.SHOW_HTTP_HEADERS_X_XSS %}
                <div class="col-md-6">
                    <h4>{% trans "X-XSS-Protection updates" %}</h4>
                    <p>{% trans "RSS feed teaser" %} <a href="/data/feed/http_security_header_x_xss_protection"
                                                        target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</p>
                    <span id="latest_http_security_header_x_xss_protection"></span>
                </div>
                {% endif %}

            </div>
        </div>
        {% endif %}
    </div>
</section>
{% endif %}

{% if config.SHOW_COMPLY_OR_EXPLAIN %}
<section name="comply_or_explain_info">
    <div class="container">
        <div id="comply_or_explain">
            <div class="page-header">
                <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                <a name="comply_or_explain_info" class="jumptonav"></a>
                <h2><i class='fas fa-comments'></i> {% trans "Comply or explain" %}</h2>
                <p>
                {% trans "Comply or explain introduction" %}
                    {% if config.SHOW_DATASETS %}
                        {% blocktrans %}You can download the entire dataset for further analysis in the <a href="#datasets">datasets</a> section.{% endblocktrans %}
                    {% endif %}
                </p>

                {%  if config.SHOW_COMPLY_OR_EXPLAIN_DISCUSS %}
                    <p>{% blocktrans with COMPLY_OR_EXPLAIN_DISCUSSION_FORUM_LINK=config.COMPLY_OR_EXPLAIN_DISCUSSION_FORUM_LINK %}
                        The comply or explain argumentation can be discussed here:
                        <a href="{{ COMPLY_OR_EXPLAIN_DISCUSSION_FORUM_LINK }}" target="_blank" title="Comply or explain forum.">comply or explain forum</a>.
                    {% endblocktrans %}
                    </p>

                {% endif %}
            </div>


            <template v-for="explain in explains">
                <div class="row">

                    <div class="col-md-10">
                        <div class="chat_quote_left">
                            <del>
                            <span :class="'awarded_points_' + explain.original_severity">
                                {% verbatim %}{{ translate(explain.original_severity) }}{% endverbatim %}
                            </span>&nbsp;&nbsp;
                            {% verbatim %}{{ translate(explain.scan_type) }}{% endverbatim %}:
                            {% verbatim %}{{ translate(explain.original_explanation) }}{% endverbatim %}
                            </del>
                        </div>
                        <br>
                        <blockquote class="blockquote text-right chat_quote_right">
                            <p class="mb-0">
                                {% verbatim %}{{ explain.explanation }}{% endverbatim %}
                            </p>
                            <footer class="blockquote-footer">
                                {% verbatim %}{{ explain.explained_by }} <cite title="Source Title">{{ humanize(explain.explained_on) }}{% endverbatim %} </cite>
                            </footer>
                        </blockquote>

                    </div>

                    <div class="col-md-2 text-center">
                        <small>{% trans "View report" %}</small>
                        <ul style="padding-left: 0px">
                            <li v-for="organization in explain.organizations" class="explain_reports">
                                <a @click="showreport(organization.id)" :title="'View report for ' + organization.name">
                                <i class="far fa-file-alt"></i> {% verbatim %}{{ organization.name }}{% endverbatim %}
                                </a>
                            </li>
                        </ul>
                    </div>

                </div>
            </template>

            <div class="row" v-if="!explains.length">
                <div class="col-md-12">
                    {% trans "No explanations yet." %}
                </div>
            </div>

            <div class="row">
                <div class="col-md-12 text-center">
                    <button type="button" class="btn btn-primary" @click="showmore()" v-show="more_available">{% trans "Show more" %}</button>
                </div>
            </div>

        </div>
    </div>
</section>
{% endif %}


{% if config.SHOW_SCAN_SCHEDULE %}
<section name="scan_schedule">
    <div class="container">
        <div id="schedule">
            <div class="page-header">
                <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                <a name="schedule" class="jumptonav"></a>
                <h2><i class="far fa-clock"></i> {% trans "Scan schedule" %}</h2>
                {% trans "Below scans and tasks will be performed in the future. This can help you getting a better perspective on when updates will be hapening to your organization. Note that all times are approximate due to caching and rounding. The time listed is the time the scan starts, it might take a while before your organization is scanned." %}
                <p></p>
            </div>
            <div class="row schedule_row" v-for="next_item in next">
                {% verbatim %}
                <div class="col-md-3 schedule_item">
                    {{ next_item.human_date }}
                </div>
                <div class="col-md-9 schedule_item" v-html="next_item.name">
                </div>
                {% endverbatim %}
            </div>
        </div>
    </div>
</section>
{% endif %}

{% if config.SHOW_DATASETS %}
<section name="datasets">
    <div class="container">
        <div id="export">
            <div class="page-header">
                <a href="#" class="backtomap">{% trans "back to map" %} ↑</a>
                <a name="datasets" class="jumptonav"></a>
                <h2><i class="fas fa-download"></i> {% trans "Datasets" %}</h2>
                {% trans "Datasets explanation" %}
                <p></p>
            </div>
            <div class="row">
                <div class="col-md-4" v-for="layer in layers">
                    <table style="width:100%" class="table table-striped">
                        <thead>
                            <tr>
                                <th colspan="2"><h3><i class="fas fa-chart-pie"></i> {% verbatim %}{{ translate("category_menu_" + layer) }}{% endverbatim %}</h3></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th><i class="fas fa-list-ul"></i> {% trans "Only urls" %}</th>
                                <td>⬇️ <a :href="create_link(layer, 'urls_only')">{% trans "Download" %}</a></td>
                            </tr><tr>
                                <th><i class="fas fa-city"></i> {% trans "Organization types" %}*</th>
                                <td>⬇️ <a :href="create_link(layer, 'organization_types')">{% trans "Download" %}</a></td>
                            </tr><tr>
                                <th><i class="fas fa-building"></i> {% trans "Organizations" %}*</th>
                                <td>⬇️ <a :href="create_link(layer, 'organizations')">{% trans "Download" %}</a></td>
                            </tr><tr>
                                <th><i class="fas fa-map-marker-alt"></i> {% trans "Map Data" %}*</th>
                                <td>⬇️ <a :href="create_link(layer, 'coordinates')">{% trans "Download" %}</a></td>
                            </tr><tr>
                                <th><i class="far fa-compass"></i> {% trans "Urls" %}*</th>
                                <td>⬇️ <a :href="create_link(layer, 'urls')">{% trans "Download" %}</a></td>
                            </tr>
                            {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                                <tr>
                                    <th><i class="fas fa-comments"></i>  {% trans "Explanations" %}</th>
                                    <td>⬇️ <a :href="create_link(layer, 'explains')">{% trans "Download" %}️</a></td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                    <br /><br />
                    <p>* = {% trans "export_failmap_compatible_explained" %}</p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}


<section id="lastrow">
    <div class="container">
        <div class="row">
            <a name="footer" class="jumptonav"></a>

            <div class="col-md-3">

                {% if config.PROJECT_NAME %}
                    <a href="{{ config.RESPONSIBLE_ORGANIZATION_WEBSITE }}" target="_blank"><b>{{ config.PROJECT_NAME }}</b></a><br />
                {% endif %}
                {% if config.PROJECT_TAGLINE %}
                    <i>{{ config.PROJECT_TAGLINE }}</i><br />
                {% endif %}

                {% if config.SHOW_DONATION %}
                    <a class="btn btn-success btn-lg btn-block" href="https://useplink.com/payment/qaCyn8t6Tar7c5zVS6Fa/" target="_blank">{% trans "Support us, donate here!" %}</a>
                {% endif %}

                <ul>
                    <li>{% trans "General inquiry e-mail" %}: <a href="mailto:{{ config.PROJECT_MAIL }}" target="_blank"><i class="fas fa-envelope-square"></i></a></li>
                    <li>{% trans "Issues e-mail" %}: <a href="mailto:{{ config.PROJECT_ISSUE_MAIL }}" target="_blank"><i class="fas fa-envelope-square"></i></a></li>
                    {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                        <li>{% trans "Comply or explain" %}: <a href="mailto:{{ config.COMPLY_OR_EXPLAIN_EMAIL_ADDRESS }}" target="_blank"><i class="fas fa-envelope-square"></i></a></li>
                    {%  endif %}

                    <li>
                        {% if config.PROJECT_TWITTER or config.PROJECT_FACEBOOK %}
                            {% trans "Also on social media" %}:

                            {% if config.PROJECT_TWITTER %}
                            <a href="{{ config.PROJECT_TWITTER }}" target="_blank"><i class="fab fa-twitter-square"></i></a>
                            {% endif %}

                            {% if config.PROJECT_FACEBOOK %}
                            <a href="{{ config.PROJECT_TWITTER }}" target="_blank"><i class="fab fa-facebook-square"></i></a>
                            {% endif %}

                        {% endif %}
                    </li>
                </ul>



            </div>

            <div class="col-md-3">
                <b>{% trans "About this website" %}</b>
                <ul>
                    <li>⬇️ <a href="https://gitlab.com/failmap/" target="_blank" rel="noopener">{% trans "Get the sourcecode" %}</a></li>
                    <li>📖 <a href="https://docs.failmap.org" target="_blank" rel="noopener">{% trans "Documentation" %}</a></li>
                </ul>
            </div>

            <div class="col-md-3">
                <b>{% trans "Made possible by" %}</b>
                <ul>
                    <li>🗺️ <a href="https://internetcleanup.foundation" target="_blank" rel="noopener">Internet Cleanup Foundation</a></li>
                    <li>ℹ️ <a href="https://www.sidnfonds.nl/" target="_blank" rel="noopener">SIDN fonds</a></li>
                </ul>
            </div>
            <div class="col-md-3">
                {% if config.RESPONSIBLE_ORGANIZATION_NAME %}
                <b>{% trans "This website is run by" %}</b>
                {% endif %}

                <ul>
                    {% if config.RESPONSIBLE_ORGANIZATION_WEBSITE %}
                    <li>🖥️ <a href="{{ config.RESPONSIBLE_ORGANIZATION_WEBSITE }}" target="_blank" rel="noopener">{{ config.RESPONSIBLE_ORGANIZATION_NAME }}</a></li>
                    {% endif %}

                    <li>{% trans "Contact" %}:
                        {% if config.RESPONSIBLE_ORGANIZATION_MAIL %}
                        <a href="mailto:{{ config.RESPONSIBLE_ORGANIZATION_MAIL }}" target="_blank"><i class="fas fa-envelope-square"></i></a>
                        {% endif %}

                        {% if config.RESPONSIBLE_ORGANIZATION_TWITTER %}
                        <a href="{{ config.RESPONSIBLE_ORGANIZATION_TWITTER }}" target="_blank" rel="noopener"><i class="fab fa-twitter-square"></i></a>
                        {% endif %}

                        {% if config.RESPONSIBLE_ORGANIZATION_FACEBOOK %}
                        <a href="{{ config.RESPONSIBLE_ORGANIZATION_FACEBOOK }}" target="_blank" rel="noopener"><i class="fab fa-facebook-square"></i></a>
                        {% endif %}

                        {% if config.RESPONSIBLE_ORGANIZATION_LINKEDIN %}
                        <a href="{{ config.RESPONSIBLE_ORGANIZATION_LINKEDIN }}" target="_blank" rel="noopener"><i class="fas fa-linkedin"></i></a>
                        {% endif %}

                        {% if config.RESPONSIBLE_ORGANIZATION_WHATSAPP %}
                        <a href="{{ config.RESPONSIBLE_ORGANIZATION_WHATSAPP }}" target="_blank" rel="noopener"><i class="fab fa-whatsapp-square"></i></a>
                        {% endif %}

                        {% if config.RESPONSIBLE_ORGANIZATION_PHONE %}
                        <a href="sip://{{ config.RESPONSIBLE_ORGANIZATION_PHONE }}" target="_blank" rel="noopener"><i class="fas fa-phone-square"></i></a>
                        {% endif %}
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

{% if config.SHOW_TICKER %}
<div id="ticker" v-cloak>
    <div id="ticker_bar" v-if="visible">
        <p class="marquee very-huge"><span><span v-html="get_tickertext()"></span></span></p>
    </div>
</div>
{% endif %}

<div id="viewmore">
    <span><a href="#info"><i class="fas fa-chevron-circle-down"></i> {% trans "Review many more details below!" %} <i class="fas fa-chevron-circle-down"></i></a></span>
</div>

</body>

<!-- todo: Only the close buttons differ from the original report. Use one template for both if possible. -->
<script type="x-template" id="fullscreenreport">

    {% verbatim %}
    <div class="page-header" id="fullscreenreport" v-if="visible">
        <div v-if="name" class="fullscreenlayout">
            <p class="closebutton" onclick="vueFullScreenReport.hide()">
                <i class="fas fa-window-close"></i>
            </p>
        {% endverbatim %}

                    <h3>{% trans "Report for" %} {% verbatim %}{{ name }}{% endverbatim %}</h3>
                    <br />
                    <a onclick="vueFullScreenReport.hide()" class="btn btn-primary" style="color:white;"><i class="fas fa-times"></i> {% trans "close report" %}</a>
                    <a @click="printreport('reportcontent')" class="btn btn-success" style="color:white;"><i class="fas fa-print"></i> {% trans "print report" %}</a>
                    <br /><br />
                    <div class="score high">
                        <span class="score_value high_text">{% verbatim %}{{ high }}{% endverbatim %}</span><br/>
                        <span class="score_label">{% trans "High" %}</span>
                    </div>

                    <div class="score medium">
                        <span class="score_value medium_text">{% verbatim %}{{ medium }}{% endverbatim %}</span><br/>
                        <span class="score_label">{% trans "Medium" %}</span>
                    </div>

                    <div class="score low">
                        <span class="score_value low_text">{% verbatim %}{{ low }}{% endverbatim %}</span><br/>
                        <span class="score_label">{% trans "Low" %}</span>
                    </div>

                    <br style="clear: both">
                    <br>

                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="organization_vulnerability_timeline"></canvas>
                    </div>

                    <br style="clear: both">
                    <br>
                    <div class="chart-container" style="position: relative; height:555px; width:100%">
                        <canvas id="organization_connectivity_timeline"></canvas>
                    </div>

                    <br style="clear: both">
                    <br />
                    <i>{% trans "Data from" %}: {% verbatim %}{{ humanize(when) }}{% endverbatim %}.</i><br/>
                    <br/>
                    <ul>
                    <li v-if="promise" id="promise"><strong>*</strong> {% trans "Promise message" %}
                    </li>
                    <li>{% trans "RSS change feed teaser" %}
                    <a :href="'/data/updates_on_organization_feed/' + selected"
                    target="_blank"> <i class="fas fa-rss"></i> {% trans "rss feed" %}</a>.</li>
                    <li>
                    {% trans "Report ask domains leader" %} <a
                        :href="'mailto:{{ config.PROJECT_ISSUE_MAIL }}?subject={% trans "Report ask domains subject" %}' + name + '&body={% trans "Report ask domains body" %}'">{% trans "Report ask sendin domains" %}</a><br/>
                    </li>
                    </ul>
                    <br/>
                    {% verbatim %}
                    <div v-for="url in urls" class="perurl"
                         :style="'background: linear-gradient(' + colorizebg(url.high, url.medium, url.low) + ', rgba(255, 255, 255, 0.0));'">

                        <div class="row">
                            <div class="col-md-4">
                                &nbsp;
                            </div>
                            <div class="col-md-8">
                                <span v-html="total_awarded_points(url.high, url.medium, url.low)"> </span>
                                <span class="faildomain" :class="colorize(url.high, url.medium, url.low)" :data-tooltip-content="idizetag(url.url)">{{ url.url }}</span><br/>
                                <a :href="'mailto:{% endverbatim %}{{ config.PROJECT_ISSUE_MAIL }}{% verbatim %}?subject={% endverbatim %}{% trans "Incorrect finding on mail subject" %}{% verbatim %}' + url.url + '&body={% endverbatim %}{% trans "Incorrect finding on mail body" %}{% verbatim %}'" class="btn btn-secondary btn-sm" style="margin-top: 11px;" role="button">
                                    {% endverbatim %}{% trans "Report incorrect finding" %}</a>
                            </div>
                        </div>

                        <!-- url reports -->
                        <div v-if="url.ratings.length > 0" class="row">
                            <div class="col-md-4">
                                &nbsp;
                            </div>
                            <div class="col-md-8 giveroom_url">
                                <h4>{% trans "Url level findings" %}</h4>
                                {% verbatim %}
                                <div v-for="rating in url.ratings">
                                    <h5>&nbsp; {{ create_header(rating) }}</h5>
                                    <div class="finding_block">
                                        <span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                        {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}
                                        <div class="finding_references">
                                                <span v-html="second_opinion_links(rating, url)"> </span>
                                                {% endverbatim %}
                                                {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                                                    <span class="explain_link" v-html="explain_link('{{ config.COMPLY_OR_EXPLAIN_EMAIL_ADDRESS }}', rating, url)"></span>
                                                {% endif %}{% verbatim %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- endpoint reports -->
                        <div v-for="endpoint in url.endpoints" class="row">
                            <div class="col-md-4 giveroom photobar">
                                <a :href="endpoint.protocol + '://' + url.url + ':' + endpoint.port"
                                   target="_blank"
                                   :title="'Visit ' + endpoint.protocol + '://' + url.url + ':' + endpoint.port">
                                    <img src="data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs="
                                         class="lazyload clippedimage" :data-src="'/static/images/screenshots/' + endpoint.ip_version + '_' + endpoint.protocol + idize(url.url) + endpoint.port + '_latest.png'"
                                        :alt="'Latest screenshot of '+ endpoint.protocol + idize(url.url) + endpoint.port"
                                    />
                                </a>
                            </div>
                            <div class="col-md-8 giveroom">
                                <h4>{% endverbatim %}{% trans "Service" %}: {% verbatim %}{{endpoint_type(endpoint) }}</h4>

                                <div>
                                    <div v-for="rating in endpoint.ratings">
                                        <h5>&nbsp; {{ create_header(rating) }}</h5>
                                        <div class="finding_block" v-if="rating.comply_or_explain_valid_at_time_of_report">
                                            <span class="awarded_points_explained">{% endverbatim %}{% trans "Explained" %}{% verbatim %}</span> {{ rating.comply_or_explain_explanation }}<br />
                                            {% endverbatim %}{% trans "Explained on" %}{% verbatim %}: {{ humanize(rating.comply_or_explain_explained_on) }}, {% endverbatim %}{% trans "explanation expires" %}{% verbatim %}: {{ humanize(rating.comply_or_explain_explanation_valid_until) }}<br>
                                            <del style="font-size: 0.8em"><span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                            {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}</del>
                                            <div class="finding_references" v-html="second_opinion_links(rating, url)"> </div>
                                        </div>
                                        <div class="finding_block" v-else>
                                            <span v-html="awarded_points(rating.high, rating.medium, rating.low)"></span> {{ translate(rating.explanation) }}<br/>
                                            {% endverbatim %}{% trans "Since" %}{% verbatim %}: {{ humanize(rating.since) }}, {% endverbatim %}{% trans "Last check" %}{% verbatim %}: {{ humanize(rating.last_scan) }}

                                            <div class="finding_references">
                                                <span v-html="second_opinion_links(rating, url)"> </span>
                                                {% endverbatim %}
                                                {% if config.SHOW_COMPLY_OR_EXPLAIN %}
                                                    <span class="explain_link" v-html="explain_link('{{ config.COMPLY_OR_EXPLAIN_EMAIL_ADDRESS }}', rating, url)"></span>
                                                {% endif %}
                                            </div>
                                            {% verbatim %}
                                        </div>
                                    </div>
                                </div>

                    </div>
                </div>
                {% endverbatim %}
            </div>

        </div>
    </div>
</script>
<script type="x-template" id="latest_table">
    <table class="table table-striped changes" :id="element_id">
        <thead>
        <tr>
            <th>{% trans "Scan moment" %}</th>
            <th>{% trans "Url" %}</th>
        </tr>
        </thead>
        <tbody v-for='scan in scans'>
        {% verbatim %}
        <tr :class="rowcolor(scan)">
            <td class="date">{{ scan.last_scan_humanized }}</td>
            <td class="url">{{ scan.url }}</td>
        </tr>
        <tr>
            <td class="service">{{ scan.service }}</td>
            <td colspan="2" class="explanation">{{ translate(scan.explanation) }}</td>
        </tr>
        {% endverbatim %}
        </tbody>
    </table>
</script>
<script type="x-template" id="historycontrol_template">
    <div id="historycontrol">
        <h4>{% trans "Moment" %}</h4>
        <h5>{% verbatim %}{{ visibleweek }}{% endverbatim %} <span v-if='loading'><div class="fa fa-spinner fa-spin"></div></span></h5>
        <input id='history' type='range' v-on:change='show_week' :value='week' min='0' max='52' step='1' :disabled='loading'/><br />
        <input id='previous_week' type='button' v-on:click='previous_week()' :disabled='loading' value='&lt;&lt;&lt; {% trans "One week earlier" %}'/>
        <input id='next_week' type='button' v-on:click='next_week()' :disabled='loading' value='{% trans "One week later" %} &gt;&gt;&gt;'/>
        <br /><br />
    {% if config.SHOW_DNS_DNSSEC or config.SHOW_HTTP_TLS_QUALYS or config.SHOW_HTTP_MISSING_TLS or config.SHOW_FTP or config.SHOW_HTTP_HEADERS_HSTS or config.SHOW_HTTP_HEADERS_XFO or config.SHOW_HTTP_HEADERS_X_XSS or config.SHOW_HTTP_HEADERS_X_CONTENT %}
        <h4>{% trans "Risk filter" %}</h4>
        {% if config.SHOW_DNS_DNSSEC %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="DNSSEC" id="DNSSEC"> <label for="DNSSEC">{% trans "report_header_DNSSEC" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_TLS_QUALYS %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="tls_qualys_encryption_quality" id="tls_qualys_encryption_quality"> <label for="tls_qualys_encryption_quality">{% trans "report_header_tls_qualys_encryption_quality" %}</label><br />
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="tls_qualys_certificate_trusted" id="tls_qualys_certificate_trusted"> <label for="tls_qualys_certificate_trusted">{% trans "report_header_tls_qualys_certificate_trusted" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_MISSING_TLS %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="plain_https" id="plain_https"> <label for="plain_https">{% trans "report_header_plain_https" %}</label><br />
        {% endif %}
        {% if config.SHOW_FTP %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="ftp" id="ftp"> <label for="ftp">{% trans "report_header_ftp" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_HEADERS_HSTS %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="http_security_header_strict_transport_security" id="HSTS"> <label for="HSTS">{% trans "report_header_http_security_header_strict_transport_security" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_HEADERS_XFO %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="http_security_header_x_frame_options" id="XFO"> <label for="XFO">{% trans "report_header_http_security_header_x_frame_options" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_HEADERS_X_XSS %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="http_security_header_x_xss_protection" id="X_XSS"> <label for="X_XSS">{% trans "report_header_http_security_header_x_xss_protection" %}</label><br />
        {% endif %}
        {% if config.SHOW_HTTP_HEADERS_X_CONTENT %}
        <input type='radio' v-model="displayed_issue" name="displayed_issue" value="http_security_header_x_content_type_options" id="X_CONTENT"> <label for="X_CONTENT">{% trans "report_header_http_security_header_x_content_type_options" %}</label><br />
        {% endif %}
        <button type="button" class="btn btn-success btn-sm" @click="clear_filter()" v-show="displayed_issue">{% trans "Clear Filter" %}</button><br />
    {% endif %}
    </div>
</script>
<script type="x-template" id="domainlist_template">
    <div id="domainlist">
        <div v-if="urls.length > 1" v-cloak>
            <table width='100%'>
                <thead>
                    <tr>
                        <th style='min-width: 20px; width: 20px;'>{% trans "H" %}</th>
                        <th style='min-width: 20px; width: 20px;'>{% trans "M" %}</th>
                        <th style='min-width: 20px; width: 20px;'>{% trans "L" %}</th>
                        <th>{% trans "Url" %}</th>
                    </tr>
                </thead>
                {% verbatim %}
                <tbody>
                    <tr v-for="url in urls">
                        <td><span v-bind:class="colorize(url.high, url.medium, url.low)">{{ url.high }}</span></td>
                        <td><span v-bind:class="colorize(url.high, url.medium, url.low)">{{ url.medium }}</span></td>
                        <td><span v-bind:class="colorize(url.high, url.medium, url.low)">{{ url.low }}</span></td>
                        <td nowrap><span v-bind:class="colorize(url.high, url.medium, url.low)">{{ url.url }}</span></td>
                    </tr>
                </tbody>
                {% endverbatim %}
            </table>
        </div>
    </div>
</script>
{% verbatim %}
<script type="x-template" id="map_item_hover">
    <div id="map_hover_info_contents">
        <div v-if="properties.organization_name" v-cloak>
            <h4>{{ properties.organization_name }}</h4>
            <div class="progress">
                <div class="progress-bar bg-danger" :style="{width:high}"></div>
                <div class="progress-bar bg-warning" :style="{width:medium}"></div>
                <div class="progress-bar bg-success" :style="{width:low}"></div>
                <div class="progress-bar bg-success" :style="{width:perfect}"></div>
            </div>
        </div>
    </div>
</script>
{% endverbatim %}

<iframe name="print_frame" title="Print frame, used to load reports when clicking print." width="0" height="0" frameborder="0" src="about:blank"></iframe>
</html>
<!--
This page was generated with MSPAINT.EXE on {{ timestamp }} in over 9000 seconds, version: {{ version }}.
-->
